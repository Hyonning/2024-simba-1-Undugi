{% load static %}

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>언더기</title>
    <link rel="stylesheet" href="{% static 'css/accounts/signup.css' %}" />
  </head>
  <body>
    <div class="signup">
      <div class="status"></div>
      <div class="head">
        <div class="logo">
          <img
            class="image"
            src="../../project/static/assets/icons/logo.png"
            alt="logo"
          />
          <div class="name">언더기</div>
          <div class="description">매일 오르는 언덕을 조금 더 즐겁게</div>
          <div class="separator"></div>
        </div>
      </div>
      <div class="body">
        <div class="title">
            <a href="{% url 'accounts:login' %}" class="backbutton">
                <svg class="backbtn" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">
                    <path d="M16.62 2.99004C16.5039 2.87363 16.366 2.78127 16.2141 2.71826C16.0622 2.65524 15.8994 2.6228 15.735 2.6228C15.5706 2.6228 15.4078 2.65524 15.2559 2.71826C15.1041 2.78127 14.9661 2.87363 14.85 2.99004L6.54 11.3C6.4473 11.3926 6.37375 11.5024 6.32357 11.6234C6.27339 11.7444 6.24756 11.8741 6.24756 12.005C6.24756 12.136 6.27339 12.2657 6.32357 12.3867C6.37375 12.5076 6.4473 12.6175 6.54 12.71L14.85 21.02C15.34 21.51 16.13 21.51 16.62 21.02C17.11 20.53 17.11 19.74 16.62 19.25L9.38 12L16.63 4.75004C17.11 4.27004 17.11 3.47004 16.62 2.99004Z" fill="#AFAFAF"/>
                </svg>
            </a>
          <span class="signuptxt">회원가입 하기</span>
        </div>
        <form action="{% url 'accounts:signup1' %}" method="POST">
            {% csrf_token %}
        <div class="idpw">
          <div class="idsection">
            <i class="idtxt">아이디</i>
            <div class="textholder">
                <input type="text" class="id" id="id-input" name="id" placeholder="ID" required />
                <svg class="no" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" >
                    <path fill-rule="evenodd" clip-rule="evenodd" d="M22 12C22 17.523 17.523 22 12 22C6.477 22 2 17.523 2 12C2 6.477 6.477 2 12 2C17.523 2 22 6.477 22 12ZM8.111 15.889C8.01726 15.7952 7.96461 15.6681 7.96461 15.5355C7.96461 15.4029 8.01726 15.2758 8.111 15.182L11.293 12L8.111 8.818C8.01992 8.7237 7.96952 8.5974 7.97066 8.4663C7.9718 8.3352 8.02439 8.20979 8.11709 8.11709C8.20979 8.02439 8.3352 7.9718 8.4663 7.97066C8.5974 7.96952 8.7237 8.01992 8.818 8.111L12 11.293L15.182 8.111C15.2763 8.01992 15.4026 7.96952 15.5337 7.97066C15.6648 7.9718 15.7902 8.02439 15.8829 8.11709C15.9756 8.20979 16.0282 8.3352 16.0293 8.4663C16.0305 8.5974 15.9801 8.7237 15.889 8.818L12.707 12L15.889 15.182C15.9801 15.2763 16.0305 15.4026 16.0293 15.5337C16.0282 15.6648 15.9756 15.7902 15.8829 15.8829C15.7902 15.9756 15.6648 16.0282 15.5337 16.0293C15.4026 16.0305 15.2763 15.9801 15.182 15.889L12 12.707L8.818 15.889C8.72424 15.9827 8.59708 16.0354 8.4645 16.0354C8.33192 16.0354 8.20476 15.9827 8.111 15.889Z" fill="#AFAFAF"/>
                </svg>
            </div>
            <span class="error-message">
                {% for message in messages %}
                {{ message }}
                {% endfor %}
            </span>
          </div>
          <div class="pwsection">
            <i class="pwtxt">비밀번호</i>
            <div class="textholder">
                <input type="password" class="pw" id="pw-input" name="password" placeholder="Password" required />
                <svg class="invisiblebutton" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">
                    <path d="M16.1 13.3L14.65 11.85C14.8 11.0667 14.575 10.3334 13.975 9.65005C13.375 8.96672 12.6 8.70005 11.65 8.85005L10.2 7.40005C10.4833 7.26672 10.7708 7.16672 11.0625 7.10005C11.3542 7.03338 11.6667 7.00005 12 7.00005C13.25 7.00005 14.3125 7.43755 15.1875 8.31255C16.0625 9.18755 16.5 10.25 16.5 11.5C16.5 11.8334 16.4667 12.1459 16.4 12.4375C16.3333 12.7292 16.2333 13.0167 16.1 13.3ZM19.3 16.4501L17.85 15.05C18.4833 14.5667 19.0458 14.0375 19.5375 13.4626C20.0292 12.8875 20.45 12.2334 20.8 11.5C19.9667 9.81672 18.7708 8.47922 17.2125 7.48755C15.6542 6.49588 13.9167 6.00005 12 6.00005C11.5167 6.00005 11.0417 6.03338 10.575 6.10005C10.1083 6.16672 9.65 6.26672 9.2 6.40005L7.65 4.85005C8.33333 4.56672 9.03333 4.35422 9.75 4.21255C10.4667 4.07088 11.2167 4.00005 12 4.00005C14.5167 4.00005 16.7583 4.69588 18.725 6.08755C20.6917 7.47922 22.1167 9.28338 23 11.5C22.6167 12.4834 22.1125 13.3959 21.4875 14.2375C20.8625 15.0792 20.1333 15.8167 19.3 16.4501ZM19.8 22.6L15.6 18.4501C15.0167 18.6334 14.4292 18.7709 13.8375 18.8626C13.2458 18.9542 12.6333 19 12 19C9.48333 19 7.24167 18.3042 5.275 16.9125C3.30833 15.5209 1.88333 13.7167 1 11.5C1.35 10.6167 1.79167 9.79588 2.325 9.03755C2.85833 8.27922 3.46667 7.60005 4.15 7.00005L1.4 4.20005L2.8 2.80005L21.2 21.2001L19.8 22.6ZM5.55 8.40005C5.06667 8.83338 4.625 9.30838 4.225 9.82505C3.825 10.3417 3.48333 10.9 3.2 11.5C4.03333 13.1834 5.22917 14.5209 6.7875 15.5126C8.34583 16.5042 10.0833 17.0001 12 17.0001C12.3333 17.0001 12.6583 16.9792 12.975 16.9376C13.2917 16.8959 13.6167 16.85 13.95 16.8L13.05 15.85C12.8667 15.9001 12.6917 15.9375 12.525 15.9626C12.3583 15.9875 12.1833 16 12 16C10.75 16 9.6875 15.5625 8.8125 14.6875C7.9375 13.8125 7.5 12.75 7.5 11.5C7.5 11.3167 7.5125 11.1417 7.5375 10.975C7.5625 10.8084 7.6 10.6334 7.65 10.45L5.55 8.40005Z" fill="#AFAFAF"/>
                </svg>
            </div>
            <p id="pwrule">&#8226; 비밀번호를 8자 이상으로 작성해주세요.<br>
                &#8226; 영문 대소문자, 숫자, 특수문자를 하나 이상 포함해주세요.<br>
                &#8226; 사용가능 특수문자: @ ! ? - _
            </p>
          </div>
          <div class="pwchecksection">
            <i class="pwchecktxt">비밀번호 확인</i>
            <div class="textholder">
                <input type="password" class="pwcheck" id="pwcheck-input" name="confirm" placeholder="Password" required />
                <svg class="invisiblebutton2" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">
                    <path d="M16.1 13.3L14.65 11.85C14.8 11.0667 14.575 10.3334 13.975 9.65005C13.375 8.96672 12.6 8.70005 11.65 8.85005L10.2 7.40005C10.4833 7.26672 10.7708 7.16672 11.0625 7.10005C11.3542 7.03338 11.6667 7.00005 12 7.00005C13.25 7.00005 14.3125 7.43755 15.1875 8.31255C16.0625 9.18755 16.5 10.25 16.5 11.5C16.5 11.8334 16.4667 12.1459 16.4 12.4375C16.3333 12.7292 16.2333 13.0167 16.1 13.3ZM19.3 16.4501L17.85 15.05C18.4833 14.5667 19.0458 14.0375 19.5375 13.4626C20.0292 12.8875 20.45 12.2334 20.8 11.5C19.9667 9.81672 18.7708 8.47922 17.2125 7.48755C15.6542 6.49588 13.9167 6.00005 12 6.00005C11.5167 6.00005 11.0417 6.03338 10.575 6.10005C10.1083 6.16672 9.65 6.26672 9.2 6.40005L7.65 4.85005C8.33333 4.56672 9.03333 4.35422 9.75 4.21255C10.4667 4.07088 11.2167 4.00005 12 4.00005C14.5167 4.00005 16.7583 4.69588 18.725 6.08755C20.6917 7.47922 22.1167 9.28338 23 11.5C22.6167 12.4834 22.1125 13.3959 21.4875 14.2375C20.8625 15.0792 20.1333 15.8167 19.3 16.4501ZM19.8 22.6L15.6 18.4501C15.0167 18.6334 14.4292 18.7709 13.8375 18.8626C13.2458 18.9542 12.6333 19 12 19C9.48333 19 7.24167 18.3042 5.275 16.9125C3.30833 15.5209 1.88333 13.7167 1 11.5C1.35 10.6167 1.79167 9.79588 2.325 9.03755C2.85833 8.27922 3.46667 7.60005 4.15 7.00005L1.4 4.20005L2.8 2.80005L21.2 21.2001L19.8 22.6ZM5.55 8.40005C5.06667 8.83338 4.625 9.30838 4.225 9.82505C3.825 10.3417 3.48333 10.9 3.2 11.5C4.03333 13.1834 5.22917 14.5209 6.7875 15.5126C8.34583 16.5042 10.0833 17.0001 12 17.0001C12.3333 17.0001 12.6583 16.9792 12.975 16.9376C13.2917 16.8959 13.6167 16.85 13.95 16.8L13.05 15.85C12.8667 15.9001 12.6917 15.9375 12.525 15.9626C12.3583 15.9875 12.1833 16 12 16C10.75 16 9.6875 15.5625 8.8125 14.6875C7.9375 13.8125 7.5 12.75 7.5 11.5C7.5 11.3167 7.5125 11.1417 7.5375 10.975C7.5625 10.8084 7.6 10.6334 7.65 10.45L5.55 8.40005Z" fill="#AFAFAF"/>
                </svg>
            </div>
            <p id="pwcheckcomment">비밀번호를 다시 한 번 입력해 주세요.</p>
            <p id="pwError">비밀번호가 일치하지 않습니다!</p>
          </div>
        </div>
        <div class="next">
            <div class="nextgo">
                <button type="submit" id="nextbtn">다음</a>
            </div>
        </div>
        </form>
      </div>
      {% include 'shared/_navbar.html' %}
    </div>

    <div class="overlay3"></div>
    <div id="myModal3" class="modal3">
      <div class="modalsection">
        <span class="close3">&times; </span>
        <p class="text1">
          로그인 후 이용해 주세요!<i class="text2"
            ><br />언더기와 함께<br />
            나만의 칼로리 데이터를 만들어봐요.</i
          >
        </p>

        <img
          class="image3"
          src="../../project/static/assets/icons/rundugi.png"
          alt="rundugi"
        />
      </div>
    </div>

    <script>
        document.addEventListener("DOMContentLoaded", function () {
            const pwInput = document.getElementById('pw-input');
            const pwCheckInput = document.getElementById('pwcheck-input');
            const nextBtn = document.getElementById('nextbtn');
            const pwError = document.getElementById('pwError');
            const idInput = document.getElementById("id-input");
            const clearIcon = document.querySelector(".no");
            const svgIcon = document.querySelector(".invisiblebutton");
            const svgIcon2 = document.querySelector(".invisiblebutton2");
        
            function validatePassword() {
                const password = pwInput.value;
                const confirmPassword = pwCheckInput.value;
                const regex = /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@!?-_]).{8,}$/;
        
                if (regex.test(password) && password === confirmPassword) {
                    nextBtn.classList.add('active');
                    nextBtn.removeAttribute('data-disabled');
                    pwError.style.display = 'none';
                } else {
                    nextBtn.classList.remove('active');
                    nextBtn.setAttribute('data-disabled', 'true');
                    if (password !== confirmPassword) {
                        pwError.style.display = 'block';
                    } else {
                        pwError.style.display = 'none';
                    }
                }
            }
        
            function clearInput() {
                idInput.value = "";
            }
        
            pwInput.addEventListener('input', validatePassword);
            pwCheckInput.addEventListener('input', validatePassword);
            nextBtn.addEventListener('click', function (event) {
                if (nextBtn.getAttribute('data-disabled') === 'true') {
                    event.preventDefault();
                }
            });
            if (svgIcon) {
                svgIcon.addEventListener("click", function () {
                    if (pwInput.type === "password") {
                        pwInput.type = "text";
                    } else {
                        pwInput.type = "password";
                    }
                });
            }

            if (svgIcon2) {
                svgIcon2.addEventListener("click", function () {
                    if (pwCheckInput.type === "password") {
                        pwCheckInput.type = "text";
                    } else {
                        pwCheckInput.type = "password";
                    }
                });
            }

            if (clearIcon) {
                clearIcon.addEventListener("click", clearInput);
                
            }
           
        });

        {% if not user.is_authenticated %}
        document.addEventListener("DOMContentLoaded", function() {
          var modal3 = document.getElementById("myModal3");
          var overlay3 = document.querySelector(".overlay3");
          var closeBtn3 = document.querySelector(".close3");

          // 랭킹 페이지 링크 클릭 시 모달 표시
          document.querySelector("a[href='{% url 'ranking:ranking_page' %}']").addEventListener("click", function(event) {
            event.preventDefault();
            modal3.style.display = "block";
            overlay3.style.display = "block";
          });

          // 마이페이지 링크 클릭 시 모달 표시
          document.querySelector("a[href='{% url 'users:mypage' %}']").addEventListener("click", function(event) {
            event.preventDefault();
            modal3.style.display = "block";
            overlay3.style.display = "block";
          });

          // 모달 닫기 버튼 클릭 시 모달 숨김
          closeBtn3.addEventListener("click", function() {
            modal3.style.display = "none";
            overlay3.style.display = "none";
          });

          // 오버레이 클릭 시 모달 숨김
          overlay3.addEventListener("click", function() {
            modal3.style.display = "none";
            overlay3.style.display = "none";
          });
        });
      {% endif %}

        
      </script>
  </body>
</html>
